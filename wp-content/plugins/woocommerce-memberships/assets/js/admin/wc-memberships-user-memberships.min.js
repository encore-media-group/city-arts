"use strict";(function(){jQuery(document).ready(function(o){var s,r,e,t,n,a,m;if(m=null!=(t=window.wc_memberships_admin)?t:{},null!=(n=window.typenow)?n:"","edit-wc_user_membership"===(e=null!=(a=window.pagenow)?a:"")||"wc_user_membership"===e)return o(".delete-membership").on("click",function(e){return confirm(m.i18n.delete_membership_confirm)}),o("input.action").on("click",function(e){var t;return e.preventDefault(),"delete"!==(t=o(this).parent("div").find("select")).val()?"export"!==t.val():confirm(m.i18n.delete_memberships_confirm)?o("#posts-filter").submit():void 0}),o(".delete-membership-and-subscription").on("click",function(e){var t;if(e.preventDefault(),confirm(m.i18n.delete_membership_confirm))return t={action:"wc_memberships_delete_membership_and_subscription",security:m.delete_user_membership_subscription_nonce,user_membership_id:o(this).data("user-membership-id"),subscription_id:o(this).data("subscription-id")},o.post(m.ajax_url,t,function(e){return console.log(e),window.location.href=m.user_membership_url})}),s=o(".js-user-membership-date").datepicker({defaultDate:"",dateFormat:"yy-mm-dd",numberOfMonths:1,showButtonPanel:!0,showOn:"button",buttonImage:m.calendar_image,buttonImageOnly:!0,onSelect:function(e){var t,n,r;return r=o(this).is("#_start_date")?"minDate":"maxDate",n=o(this).data("datepicker"),t=o.datepicker.parseDate(n.settings.dateFormat||o.datepicker._defaults.dateFormat,e,n.settings),s.not(this).datepicker("option",r,t)}}),r={opacity:.6},o("#wc-memberships-user-membership-data").on("click","a.js-calc-plan-date",function(e){var t,n,r,s,a,i;return e.preventDefault(),s=o(this).hasClass("js-calc-plan-start-date")?(i="start","wc_memberships_get_membership_plan_start_date"):(i="end","wc_memberships_get_membership_plan_end_date"),n=o("#post_parent"),r=o("#_start_date"),t=o("#_end_date"),a={action:s,security:m.get_membership_date_nonce,plan:n.val(),start_date:r.val()},o.post(m.ajax_url,a,function(e){if(e)return"start"===i?r.val(e.data.substring(0,10)):t.val(e.data.substring(0,10))})}),o("#post_parent").on("change",function(e){var t,n,r,s,a;if(s=o(this).val())return n=o("#_start_date"),t=o("#_end_date"),a={action:"wc_memberships_get_membership_plan_start_date",security:m.get_membership_date_nonce,plan:s,start_date:n.val()},o.post(m.ajax_url,a,function(e){if(e)return n.val(e.data.substring(0,10))}),r={action:"wc_memberships_get_membership_plan_end_date",security:m.get_membership_date_nonce,plan:s,start_date:n.val()},o.post(m.ajax_url,r,function(e){if(e)return t.val(e.data.substring(0,10))})}),o(".post_status_field").on("change","select#post_status",function(e){var t;if("wcm-expired"===o(this).val())return(t=o("#_end_date")).datepicker(),t.datepicker("setDate",new Date)}),o("#wc-memberships-user-membership-notes").on("click","a.js-add-note",function(e){var t,n;if(e.preventDefault(),n=o("textarea#user-membership-note").val())return o("#wc-memberships-user-membership-notes").block({message:null,overlayCSS:r}),t={action:"wc_memberships_add_user_membership_note",post_id:o("#post_ID").val(),note:n,notify:o("#note-notify").is(":checked"),security:m.add_user_membership_note_nonce},o.post(m.ajax_url,t,function(e){var t;return t=o(e),o("ul.wc-user-membership-notes").prepend(t.find("#notes").html()),o("ul.wc-user-membership-recent-activity").prepend(t.find("#recent-activity").html()),o("#wc-memberships-user-membership-notes").unblock(),o("textarea#user-membership-note").val(""),o("#note-notify").prop("checked",!1)})}).on("click","a.js-delete-note",function(e){var t,n;return e.preventDefault(),n=o(this).closest("li.note"),o(n).block({message:null,overlayCSS:r}),t={action:"wc_memberships_delete_user_membership_note",note_id:o(n).attr("rel"),security:m.delete_user_membership_note_nonce},o.post(m.ajax_url,t,function(e){return o(n).remove()})})})}).call(void 0);